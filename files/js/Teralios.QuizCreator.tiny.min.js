define("Teralios/QuizCreator/Data/Data",["require","exports"],(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Quiz=e.Goal=e.Question=void 0;e.Question=class{constructor(t,e,i,s,n,a,o,r){this.options=new Map,this.question=t,this.options.A=e,this.options.B=i,this.options.C=s,this.options.D=n,this.explanation=a,this.correct=o.toLowerCase(),this.no=r}checkAnswer(t){return(t=t.toLowerCase())==this.correct}};e.Goal=class{constructor(t,e,i,s){this.title=t,this.description=e,this.icon=i,this.minScore=s}reached(t){return t>=this.minScore}};e.Quiz=class{constructor(){this.questions=[],this.goals=[],this.questionsCount=0,this.questionIndex=0}addQuestion(t){this.questions.push(t),++this.questionsCount}addGoal(t){this.goals.push(t)}getQuestion(){return this.questionsCount<this.questionIndex?null:this.questions[this.questionIndex]}getQuestionNo(){return this.questionIndex+1}nextQuestion(){return++this.questionIndex,this.questionIndex<=this.questionsCount}getGoal(t){let e;return e=null,this.goals.length>0&&(this.goals.sort(((t,e)=>t>=e?1:-1)),this.goals.forEach((i=>{i.reached(t)&&(e=i)}))),e}}})),define("Teralios/QuizCreator/Data/Loader",["require","exports","WoltLabSuite/Core/Language","WoltLabSuite/Core/Ajax","./Data"],(function(t,e,i,s,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageLoader=e.QuizLoader=void 0;e.QuizLoader=class{constructor(t,e,i){this.quizSelector=t.startsWith("#")?t.substr(1):t,this.callbackSuccess=e,this.callbackFailure=i,this.quizID=null,this.findQuizID()}findQuizID(){let t;const e=document.getElementById(this.quizSelector);null!=e?(t=e.getAttribute("data-quiz-id"),null!=t&&(this.quizID=parseInt(t)),null!=this.quizID?s.api(this):console.error("No quiz id found.")):console.error("Quiz with id "+this.quizSelector+" not found.")}buildQuiz(){const t=new n.Quiz;if("questionList"in this.jsonData&&Array.isArray(this.jsonData.questionList)){const e=this.jsonData.questionList;let i=1;if(e.length>0&&e.forEach((e=>{var s,a,o,r,u,c,l;const d=null!==(s=String(e.question))&&void 0!==s?s:"",h=null!==(a=String(e.optionA))&&void 0!==a?a:"",m=null!==(o=String(e.optionB))&&void 0!==o?o:"",p=null!==(r=String(e.optionC))&&void 0!==r?r:"",g=null!==(u=String(e.optionD))&&void 0!==u?u:"",w=null!==(c=String(e.answer))&&void 0!==c?c:"",f=null!==(l=String(e.explanation))&&void 0!==l?l:"";""!=d&&""!=h&&""!=m&&""!=p&&""!=g&&""!=w&&(t.addQuestion(new n.Question(d,h,m,p,g,f,w,i)),++i)})),"goalList"in this.jsonData&&Array.isArray(this.jsonData.goalList)){const e=this.jsonData.goalList;e.length>0&&e.forEach((e=>{var i,s,a,o;const r=null!==(i=Number(e.points))&&void 0!==i?i:0,u=null!==(s=String(e.title))&&void 0!==s?s:"",c=null!==(a=String(e.icon))&&void 0!==a?a:"",l=null!==(o=String(e.description))&&void 0!==o?o:"";""!=u&&t.addGoal(new n.Goal(u,c,l,r))}))}}this.callbackSuccess(t)}_ajaxSetup(){return{data:{actionName:"loadQuiz",className:"wcf\\data\\quiz\\QuizAction",objectIDs:[this.quizID],parameters:{value:1}}}}_ajaxSuccess(t){this.jsonData=t.returnValues,this.buildQuiz()}_ajaxFailure(){return this.callbackFailure(),!0}};e.LanguageLoader=class{constructor(t){this.contentID=t,this.loadLanguageItems()}loadLanguageItems(){const t=document.getElementById(this.contentID),e=new Map;null!==t?(JSON.parse(t.innerHTML,((t,i)=>{"string"==typeof t&&"string"==typeof i&&e.set(t,i)})),e.size>0&&e.forEach(((t,e)=>{i.add(t,e)}))):console.log("Can not find language items.")}}})),define("Teralios/QuizCreator/Logic/Container/Header",["require","exports","WoltLabSuite/Core/Language"],(function(t,e,i){"use strict";function s(t){const e=document.createElement("div");return e.classList.add("header"),e.append(function(t){const e=document.createElement("div");e.classList.add("questionInfo");const s=document.createElement("p");s.append(i.get("wcf.quizCreator.game.header.question.prefix"),n,i.get("wcf.quizCreator.game.header.question.suffix"),a),a.textContent=String(t);const r=document.createElement("p");for(let e=0;e<t;e++){const t=document.createElement("span");t.classList.add("fa","icon16","fa-question-circle"),r.append(t),o.push(t)}return e.append(s,r),e}(t),function(){const t=document.createElement("div");t.classList.add("stopwatch");const e=document.createElement("p");e.classList.add("top","paused");const i=document.createElement("span");return i.classList.add("fa","icon16","fa-circle"),e.append(i," +",r),t.append(e,c),t}(),function(){const t=document.createElement("div");t.classList.add("score"),t.append(u,document.createElement("b")),null!=t.lastChild&&(t.lastChild.textContent=i.get("wcf.quizCreator.game.header.score"));return t}()),e}Object.defineProperty(e,"__esModule",{value:!0}),e.Header=void 0;const n=document.createElement("b"),a=document.createElement("b"),o=[],r=document.createElement("span"),u=document.createElement("span"),c=document.createElement("p");e.Header=class{constructor(t){this.container=s(t)}getView(){return this.container}updateQuestion(t){n.textContent=String(t)}updateQuestionIndicator(t,e){o[t-=1].classList.add(e?"correct":"inCorrect")}updateScore(t){u.textContent=String(t)}updateStatus(t){var e;const i=null!==(e=this.container.getElementsByClassName("stopwatch")[0])&&void 0!==e?e:null;i.classList.remove("s1","s2","s3"),i.classList.add("s1")}updateValue(t){r.textContent=String(t)}updateTime(t){const e=Math.floor(t/60),i=t%60,s=t%2==0?":":" ";c.textContent=String(e)+s+String(i)}stopAnimation(){const t=this.getStopwatchTop();null!=t&&t.classList.add("paused")}startAnimation(){const t=this.getStopwatchTop();null!=t&&t.classList.remove("paused")}getStopwatchTop(){var t;return null!==(t=this.container.getElementsByClassName("top")[0])&&void 0!==t?t:null}}})),define("Teralios/QuizCreator/Logic/Container/View/General",["require","exports","tslib","WoltLabSuite/Core/Dom/Util","WoltLabSuite/Core/Language"],(function(t,e,i,s,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.General=void 0,s=i.__importDefault(s);const a=document.createElement("span"),o=document.createElement("button");e.General=class{constructor(){this.startView=function(){const t=document.createElement("div");return t.classList.add("startView"),t.appendChild(o),o.textContent=n.get("wcf.quizCreator.game.button.star"),s.default.hide(t),t}(),this.intermissionView=function(){const t=document.createElement("div");t.classList.add("intermissionView");const e=document.createElement("p");return e.append(n.get("wcf.quizCreator.game.header.question.prefix"),a),t.appendChild(e),s.default.hide(t),t}()}updateQuestionNo(t){a.textContent=String(t)}getStartView(){return this.startView}getIntermissionView(){return this.intermissionView}registerStartCallback(t){o.addEventListener("click",t)}}})),define("Teralios/QuizCreator/Logic/Container/View/Question",["require","exports","tslib","WoltLabSuite/Core/Dom/Util","WoltLabSuite/Core/Language"],(function(t,e,i,s,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuestionView=void 0,s=i.__importDefault(s);const a=[document.createElement("button"),document.createElement("button"),document.createElement("button"),document.createElement("button")],o=document.createElement("p"),r=document.createElement("p"),u=document.createElement("button"),c=["A","B","C","D"];e.QuestionView=class{constructor(t,e){this.registerAnswer=t,this.goToNextQuestion=e,this.viewContainer=document.createElement("div"),this.viewContainer.classList.add("questionView"),s.default.hide(this.viewContainer),this.viewContainer.append(function(){const t=document.createElement("div");return t.classList.add("question"),t.appendChild(o),t}(),function(){const t=document.createElement("ul");return t.classList.add("optionButtons"),a.forEach((e=>{const i=document.createElement("li");i.appendChild(e),t.appendChild(i)})),t}(),function(){const t=document.createElement("div");return t.classList.add("explanation","invisible"),t.appendChild(r),t}(),function(){u.textContent=n.get("wcf.quizCreator.game.button.next");const t=document.createElement("div");return t.appendChild(u),t}()),this.prepareButtons()}getView(){return this.viewContainer}prepareFor(t,e){this.question=t,a.sort((()=>.5-Math.random())),c.forEach(((t,e)=>{a[e].setAttribute("data-option",t.toLowerCase()),a[e].textContent=this.question.options[t]})),e&&(u.textContent=n.get("wcf.quizCreator.game.button.last"),this.goToNextQuestion=e)}checkAnswer(t){var e;const i=t.target;null!==i&&i instanceof HTMLElement&&(this.selectedOption=null!==(e=i.getAttribute("data-option"))&&void 0!==e?e:"",this.selectedOption=this.selectedOption.toLowerCase(),this.updateField(this.registerAnswer(this.selectedOption)))}nextQuestion(){u.disabled=!0,u.classList.add("invisible"),r.classList.add("invisible"),this.goToNextQuestion()}updateField(t){a.forEach((e=>{var i;let s=null!==(i=e.getAttribute("data-option"))&&void 0!==i?i:"";s=s.toLowerCase(),t?e.classList.add("correct"):s==this.selectedOption&&e.classList.add("incorrect"),e.disabled=!0})),r.textContent=this.question.explanation,r.classList.remove("invisible"),u.disabled=!1,u.classList.remove("invisible")}prepareButtons(){a.forEach((t=>{t.addEventListener("click",(t=>{this.checkAnswer(t)}))})),u.addEventListener("click",(()=>{this.nextQuestion()}))}}})),define("Teralios/QuizCreator/Logic/Container/Main",["require","exports","tslib","./View/General","./View/Question","WoltLabSuite/Core/Dom/Util"],(function(t,e,i,s,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Main=e.setEffectBasics=void 0,a=i.__importDefault(a);let o=1e3;e.setEffectBasics=function(t){o=1e3*t};e.Main=class{constructor(t,e,i,s,n){this.showQuestionCallback=t,this.checkAnswerCallback=e,this.nextQuestionCallback=i,this.finishGameCallback=s,this.startGameCallback=n,this._initGeneral()}nextQuestion(t,e){this.container.classList.contains("show")&&this.container.classList.remove("show"),e?this.questionView.prepareFor(t,this.finishGameCallback):this.questionView.prepareFor(t),setTimeout((()=>{this.intermission()}),o)}intermission(){a.default.hide(this.currentView),this.currentView=this.generalView.getIntermissionView(),a.default.show(this.currentView),this.container.classList.add("show"),setTimeout((()=>{this.showNext()}),2e3+o)}showNext(){this.container.classList.remove("show"),setTimeout((()=>{a.default.hide(this.currentView),this.currentView=this.questionView.getView(),a.default.show(this.currentView),this.container.classList.add("show"),this.finalizeNext()}),o)}finalizeNext(){setTimeout((()=>{this.container.classList.add("show"),this.showQuestionCallback()}),o)}showStartView(){this.currentView=this.generalView.getStartView(),a.default.show(this.currentView),this.container.classList.add("show")}getView(){return this.container}_initGeneral(){this.questionView=new n.QuestionView(this.checkAnswerCallback,this.nextQuestionCallback),this.generalView=new s.General,this.generalView.registerStartCallback(this.startGameCallback),this.container=document.createElement("div"),this.container.classList.add("main"),this.container.append(this.generalView.getStartView(),this.generalView.getIntermissionView(),this.questionView.getView())}}})),define("Teralios/QuizCreator/Logic/Logic",["require","exports","tslib","./Container/Header","./Container/Main","WoltLabSuite/Core/Dom/Util"],(function(t,e,i,s,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0,a=i.__importDefault(a);e.Game=class{constructor(t,e){this.seconds=0,this.quizSeconds=0,this.score=0,this.value=0,this.quiz=t,this.container=e,this.result=[],this.init()}init(){this.header=new s.Header(this.quiz.questionsCount),this.main=new n.Main((()=>{this.startWatch()}),(t=>this.registerAnswer(t)),(()=>{this.setNextQuestion()}),(()=>{this.finishGame()}),(()=>{})),a.default.hide(this.header.getView()),a.default.hide(this.main.getView());const t=document.createElement("div");t.classList.add("gameField"),this.container.appendChild(t),this.container.append(this.header.getView()),this.container.append(this.main.getView()),alert("test"),setTimeout((()=>{this.main.showStartView()}),1e3)}registerAnswer(t){const e=this.currentQuestion.checkAnswer(t);e&&(this.score+=this.value),this.quizSeconds+=this.seconds,this.header.stopAnimation(),this.watchID&&clearInterval(this.watchID),this.header.updateScore(this.score),this.header.updateQuestionIndicator(this.currentQuestion.no,e);const i=new Map;return i.time=this.seconds,i.option=t,this.result[this.currentQuestionIndex]=i,this.seconds=0,this.value=10,e}startWatch(){this.seconds=0,this.value=10,this.header.updateValue(this.value),this.header.updateTime(this.seconds),this.header.updateStatus("s1"),this.header.startAnimation(),this.watchID=setInterval((()=>{this.clockTick()}),1e3)}setNextQuestion(){const t=this.quiz.getQuestion();null!=t&&this.main.nextQuestion(t,this.quiz.nextQuestion())}finishGame(){}clockTick(){this.seconds++,this.header.updateTime(this.seconds),this.seconds>5&&(this.value=5,this.header.updateStatus("s2"),this.header.updateValue(this.value)),this.seconds>15&&(this.value=1,this.header.updateStatus("s3"),this.header.updateValue(this.value))}}})),define("Teralios/QuizCreator/Logic",["require","exports","./Data/Loader","WoltLabSuite/Core/Language","./Logic/Logic"],(function(t,e,i,s,n){"use strict";return class{constructor(t){t.startsWith("#")?(this.selector=t,this.findField()):console.error("Selector for quiz game must be an html id selector.")}startGame(t){this.quiz=t;const e=this.gameContainer,i=document.createElement("div");i.classList.add("game"),this.gameContainer=i,e.replaceWith(i),new n.Game(this.quiz,this.gameContainer)}showError(){var t,e;const i=null!==(t=this.gameContainer.getElementsByClassName("icon")[0])&&void 0!==t?t:null,n=null!==(e=this.gameContainer.getElementsByTagName("p")[0])&&void 0!==e?e:null;null!==i&&this.gameContainer.removeChild(i),null!==n&&(n.textContent=s.get("wcf.quizCreator.game.status.error"),n.classList.add("error"))}findField(){const t=document.querySelector(this.selector+" .game");if(!(t instanceof HTMLElement))return void console.error("Can not found game field element.");this.gameContainer=t;const e=document.createElement("div"),i=document.createElement("span"),n=document.createElement("p");i.classList.add("icon","icon128","fa-spinner"),n.innerText=s.get("wcf.quizCreator.game.status.loading"),e.classList.add("statusLoading"),e.append(i,n),this.gameContainer.appendChild(e),this.loadData()}loadData(){new i.LanguageLoader("#js-QuizCreator-Language"),new i.QuizLoader(this.selector,(t=>{this.startGame(t)}),(()=>{this.showError()}))}}})),define("Teralios/QuizCreator/Dialog/Player",["require","exports","tslib","WoltLabSuite/Core/Ajax","WoltLabSuite/Core/Ui/Dialog","WoltLabSuite/Core/Language"],(function(t,e,i,s,n,a){"use strict";let o,r,u;n=i.__importStar(n);const c=(a=i.__importStar(a)).get("wcf.quizCreator.user.play.details.dialog.title");return{init(){const t=document.getElementById("showUserResult");null!==t&&(o=t,r=o.getAttribute("data-game-id"),this._loadData())},getHtml:()=>u,showDialog(){n.open(this)},_buildButton(){o.addEventListener("click",(()=>{this.showDialog()}))},_parseData(t){u=t.returnValues,this._buildButton()},_loadData(){s.apiOnce({data:{actionName:"showResult",className:"wcf\\data\\quiz\\game\\GameAction",objectIDs:[r]},success:t=>{this._parseData(t)}})},_dialogSetup(){return{id:"playerResult",source:this.getHtml(),options:{title:c}}}}}));